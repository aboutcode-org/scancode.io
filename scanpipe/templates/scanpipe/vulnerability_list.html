{% extends "scanpipe/base.html" %}
{% load humanize %}

{% block title %}ScanCode.io: Vulnerabilities{% endblock %}

{% block content %}
  <div id="content-header" class="container is-max-widescreen mb-3">
    {% include 'scanpipe/includes/navbar_header.html' %}
    <section class="mx-5">
      {% include 'scanpipe/includes/breadcrumb.html' with linked_project=True current="Vulnerabilities" %}
      <div>{{ object_list|length|intcomma }} results</div>
    </section>
  </div>

  <div class="container is-fluid mb-3">
    <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth break-word">
      {% include 'scanpipe/includes/list_view_thead.html' %}
      <tbody>
        {% for vulnerability in object_list.values %}
          <tr>
            <td>
              {% include 'scanpipe/includes/vulnerability_id.html' with vulnerability=vulnerability %}
            </td>
            <td>
              {% include 'scanpipe/includes/vulnerability_summary.html' with vulnerability=vulnerability only %}
            </td>
            <td>
              {% for obj in vulnerability.affects %}
                {{ obj }}<br>
              {% endfor %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="42" class="has-text-centered p-3">
              No Vulnerabilities found. <a href="?">Clear search and filters</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}