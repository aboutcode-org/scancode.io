<div class="content">
  <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
    <thead>
      <tr>
        <th style="width: 220px;">Affected by</th>
        <th>Summary</th>
        <th>Analysis</th>
      </tr>
    </thead>
    <tbody>
      {% for vulnerability in tab_data.fields.affected_by_vulnerabilities.value %}
        <tr>
          <td>
            <a href="{{ VULNERABLECODE_URL }}/vulnerabilities/{{ vulnerability.vulnerability_id }}" target="_blank">
              {{ vulnerability.vulnerability_id }}
              <i class="fa-solid fa-up-right-from-square is-small"></i>
            </a>
            <ul class="list-unstyled mb-0">
              {% for alias in aliases %}
                <li>
                  {% if alias|slice:":3" == "CVE" %}
                    <a href="https://nvd.nist.gov/vuln/detail/{{ alias }}" target="_blank">{{ alias }}
                      <i class="fa-solid fa-up-right-from-square mini"></i>
                    </a>
                  {% elif alias|slice:":4" == "GHSA" %}
                    <a href="https://github.com/advisories/{{ alias }}" target="_blank">{{ alias }}
                      <i class="fa-solid fa-up-right-from-square mini"></i>
                    </a>
                  {% elif alias|slice:":3" == "NPM" %}
                    <a href="https://github.com/nodejs/security-wg/blob/main/vuln/npm/{{ alias|slice:"4:" }}.json" target="_blank">{{ alias }}
                      <i class="fa-solid fa-up-right-from-square mini"></i>
                    </a>
                  {% else %}
                    {{ alias }}
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          </td>
          <td>
            {% if vulnerability.summary %}
              {% if vulnerability.summary|length > 150 %}
                <details>
                  <summary>{{ vulnerability.summary|slice:":150" }}...</summary>
                  {{ vulnerability.summary|slice:"150:" }}
                </details>
              {% else %}
                {{ vulnerability.summary }}
              {% endif %}
            {% endif %}
          </td>
          <td>
            {% for key, value in vulnerability.cdx_vulnerability.analysis.items %}
              <strong>{{ key }}:</strong> {{ value }}{% if not forloop.last %}<br>{% endif %}
            {% endfor %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>